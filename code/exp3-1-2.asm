A8255 EQU 0640H
B8255 EQU 0642H
C8255 EQU 0644H
MODE8255 EQU 0646H
 
CODE SEGMENT
	ASSUME CS:CODE
START:
    MOV DX,MODE8255
    MOV AL,90H
    OUT DX,AL
    
	PUSH DS
	MOV AX,0000H
	MOV DS,AX
	
	MOV AX,OFFSET MIR7
	MOV SI,003CH
	MOV [SI],AX
	MOV AX,CS
	MOV SI,003EH
	MOV [SI],AX
	
	MOV AX,OFFSET MIR6
	MOV SI,0038H
	MOV [SI],AX
	MOV AX,CS
	MOV SI,003AH
	MOV [SI],AX
	POP DS
 
    CLI
 
	MOV AL,11H;ICW1
	OUT 20H,AL
	MOV AL,08H;ICW2
	OUT 21H,AL
	MOV AL,04H;ICW3
	OUT 21H,AL
	MOV AL,07H;ICW4
	OUT 21H,AL
	MOV AL,3FH;OCW1 开IR6和IR7以及串口
	OUT 21H,AL
	
	STI
	
    MOV DX,B8255
    
MAIN:
    MOV AL,0FFH
    OUT DX,AL;点亮所有灯，等待被中断
    JMP MAIN
    
MIR6:
    MOV AL,0FH;低四位亮，高四位灭
	OUT DX,AL
	CALL DELAY
	IRET
	
MIR7:
    MOV AL,0F0H;高四位亮，低四位灭
    OUT DX,AL
    CALL DELAY
    IRET
	
DELAY:  
    PUSH CX
	MOV CX,0FFFFH
A0:		
    PUSH AX
	POP  AX
	LOOP A0
	POP CX	
	RET
	
CODE ENDS
     END START